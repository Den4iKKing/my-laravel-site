import{r as S,y as N,c as l,o as i,a as t,w as p,v as D,h as x,C as L,F as u,d as m,W as T,t as r,B as v,f as h,n as U}from"./app-B4k5rrsx.js";import{_ as V}from"./Dashboard-D-iSJIvD.js";const j={class:"mb-4 flex justify-between items-center space-x-4"},P={class:"relative w-1/3"},B={class:"grid grid-cols-3 gap-4 mb-4"},C={class:"text-lg font-semibold mb-2"},I={class:"bg-gray-800 p-4 rounded-md"},F={class:"w-full table-auto text-white"},M={class:"px-4 py-2"},O={class:"px-4 py-2"},R={class:"px-4 py-2"},k={class:"px-4 py-2"},H={class:"px-4 py-2"},W={class:"px-4 py-2"},z={class:"px-4 py-2"},E={class:"mt-4 flex justify-center items-center space-x-2"},$=["href","innerHTML"],q={layout:V},J=Object.assign(q,{__name:"logs",props:{logs:Object,logStatistics:Object,filters:Object},setup(d){const n=d,o=S({steamid:n.filters.steamid||"",type:n.filters.type||"",sort_by:n.filters.sort_by||"created_at",sort_direction:n.filters.sort_direction||"desc"});let y=null;const c=()=>{clearTimeout(y),y=setTimeout(()=>{T.get(route("logs.index"),o.value,{preserveState:!1,replace:!0})},500)},_=a=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(a||0),b=a=>new Date(a).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),g=a=>({buy_log:"Покупки",buy_log_new:"Корзина",payment_statistic:"Пополнения",other_log:"Плагин",promo_log:"Промокод"})[a]||a,w=N(()=>n.logs.links?n.logs.links.map(a=>{if(!a.url)return a;const s=new URL(a.url);return o.value.steamid&&s.searchParams.set("steamid",o.value.steamid),o.value.type&&s.searchParams.set("type",o.value.type),o.value.sort_by&&s.searchParams.set("sort_by",o.value.sort_by),o.value.sort_direction&&s.searchParams.set("sort_direction",o.value.sort_direction),{...a,url:s.toString()}}):[]);return(a,s)=>(i(),l("div",null,[s[6]||(s[6]=t("h1",{class:"text-2xl font-semibold text-white mb-4"},"Логи операций",-1)),t("div",j,[t("div",P,[p(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>o.value.steamid=e),onInput:c,type:"text",placeholder:"Поиск по SteamID / Name...",class:"w-full bg-gray-700 text-white p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"},null,544),[[D,o.value.steamid]])]),p(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>o.value.type=e),onChange:c,class:"bg-gray-700 text-white p-2 rounded-md"},s[3]||(s[3]=[L('<option value="">Все типы логов</option><option value="buy_log">Покупки</option><option value="buy_log_new">Корзина</option><option value="payment_statistic">Пополнения</option><option value="other_log">Плагин</option><option value="promo_log">Промокоды</option>',6)]),544),[[x,o.value.type]]),p(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>o.value.sort_direction=e),onChange:c,class:"bg-gray-700 text-white p-2 rounded-md"},s[4]||(s[4]=[t("option",{value:"desc"},"По убыванию",-1),t("option",{value:"asc"},"По возрастанию",-1)]),544),[[x,o.value.sort_direction]])]),t("div",B,[(i(!0),l(u,null,m(d.logStatistics,(e,f)=>(i(),l("div",{key:f,class:"bg-gray-800 p-4 rounded-md text-white"},[t("h3",C,r(g(f)),1),t("p",null,"Записей: "+r(e.total_count),1),t("p",null,"Сумма: "+r(_(e.total_amount)),1)]))),128))]),t("div",I,[t("table",F,[s[5]||(s[5]=t("thead",null,[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"ID"),t("th",{class:"px-4 py-2 text-left"},"Тип операции"),t("th",{class:"px-4 py-2 text-left"},"Игровой ник"),t("th",{class:"px-4 py-2 text-left"},"SteamID"),t("th",{class:"px-4 py-2 text-left"},"Название"),t("th",{class:"px-4 py-2 text-left"},"Сумма"),t("th",{class:"px-4 py-2 text-left"},"Дата создания")])],-1)),t("tbody",null,[(i(!0),l(u,null,m(d.logs.data,e=>(i(),l("tr",{key:e.id,class:"border-t border-gray-700 hover:bg-gray-700 transition"},[t("td",M,r(e.id),1),t("td",O,r(g(e.log_type)),1),t("td",R,r(e.name),1),t("td",k,r(e.steamid),1),t("td",H,[e.log_type!=="other_log"?(i(),l(u,{key:0},[h(r(e.item_name),1)],64)):v("",!0),e.log_type==="other_log"&&e.message?(i(),l(u,{key:1},[h(r(e.message),1)],64)):v("",!0)]),t("td",W,r(_(e.price)),1),t("td",z,r(b(e.created_at)),1)]))),128))])])]),t("div",E,[(i(!0),l(u,null,m(w.value,e=>(i(),l("a",{key:e.label,href:e.url,innerHTML:e.label,class:U([["px-4 py-2 rounded-md",e.active?"bg-gray-700 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500",!e.url&&"cursor-not-allowed opacity-50"],"transition-all duration-200"])},null,10,$))),128))])]))}});export{J as default};
